{
    "docs": [
        {
            "location": "/",
            "text": "Roles for Laravel 5.4\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPowerful package for handling roles in Laravel\n\n\nHistory\n\n\nThis project was largely inspired by Roman's \nromanbican/roles\n Laravel package. However at the time Laravel 5.3 was released his package was not actively maintained. I have ommitted permissions in this package in favour of Laravel's \nAuthorization\n. I intend to keep this package as simple and minimal as is possible.",
            "title": "Home"
        },
        {
            "location": "/#roles-for-laravel-54",
            "text": "Powerful package for handling roles in Laravel",
            "title": "Roles for Laravel 5.4"
        },
        {
            "location": "/#history",
            "text": "This project was largely inspired by Roman's  romanbican/roles  Laravel package. However at the time Laravel 5.3 was released his package was not actively maintained. I have ommitted permissions in this package in favour of Laravel's  Authorization . I intend to keep this package as simple and minimal as is possible.",
            "title": "History"
        },
        {
            "location": "/installation/",
            "text": "This package is very easy to set up. There are only couple of steps.\n\n\nComposer\n\n\nRun this command inside your terminal to add the package into your project.\n\n\ncomposer require httpoz/roles",
            "title": "Installation"
        },
        {
            "location": "/installation/#composer",
            "text": "Run this command inside your terminal to add the package into your project.  composer require httpoz/roles",
            "title": "Composer"
        },
        {
            "location": "/configuration/",
            "text": "Register the Roles Service Provider\n\n\nAdd the package to your application service providers in \nconfig/app.php\n file.\n\n\n'providers'\n \n=>\n \n[\n\n\n    \n/*\n\n\n     * Laravel Framework Service Providers...\n\n\n     */\n\n    \nIlluminate\\Foundation\\Providers\\ArtisanServiceProvider\n::\nclass\n,\n\n    \nIlluminate\\Auth\\AuthServiceProvider\n::\nclass\n,\n\n    \n...\n\n\n    \n/**\n\n\n     * Package Service Providers...\n\n\n     */\n\n    \nHttpOz\\Roles\\RolesServiceProvider\n::\nclass\n,\n\n\n\n],\n\n\n\n\n\n\nPublish Config File And Migrations\n\n\nPublish the package config file and migrations to your application. Run this command inside your terminal.\n\n\nphp artisan vendor:publish --provider=\"HttpOz\\Roles\\RolesServiceProvider\"\n\n\n\n\n\nAnd also run migrations.\n\n\nphp artisan migrate\n\n\n\n\n\n\n\nThis uses the default users table which is in Laravel. You should already have the migration file for the users table available and migrated.\n\n\n\n\nEnable HasRole Trait And Contract\n\n\nInclude \nHasRole\n trait and also implement \nHasRole\n contract inside your \nUser\n model.\n\n\nuse\n \nHttpOz\\Roles\\Traits\\HasRole\n;\n\n\nuse\n \nHttpOz\\Roles\\Contracts\\HasRole\n \nas\n \nHasRoleContract\n;\n\n\n\nclass\n \nUser\n \nextends\n \nAuthenticatable\n \nimplements\n \nHasRoleContract\n\n\n{\n\n    \nuse\n \nNotifiable\n,\n \nHasRole\n;\n\n\n\n\n\n\nAnd that's it!\n\n\nConfig File\n\n\nYou can change connection for models, slug separator, models path and there is also a handy pretend feature. Have a look at config file for more information.",
            "title": "Configuration"
        },
        {
            "location": "/configuration/#register-the-roles-service-provider",
            "text": "Add the package to your application service providers in  config/app.php  file.  'providers'   =>   [ \n\n     /*       * Laravel Framework Service Providers...       */ \n     Illuminate\\Foundation\\Providers\\ArtisanServiceProvider :: class , \n     Illuminate\\Auth\\AuthServiceProvider :: class , \n     ... \n\n     /**       * Package Service Providers...       */ \n     HttpOz\\Roles\\RolesServiceProvider :: class ,  ],",
            "title": "Register the Roles Service Provider"
        },
        {
            "location": "/configuration/#publish-config-file-and-migrations",
            "text": "Publish the package config file and migrations to your application. Run this command inside your terminal.  php artisan vendor:publish --provider=\"HttpOz\\Roles\\RolesServiceProvider\"  And also run migrations.  php artisan migrate   This uses the default users table which is in Laravel. You should already have the migration file for the users table available and migrated.",
            "title": "Publish Config File And Migrations"
        },
        {
            "location": "/configuration/#enable-hasrole-trait-and-contract",
            "text": "Include  HasRole  trait and also implement  HasRole  contract inside your  User  model.  use   HttpOz\\Roles\\Traits\\HasRole ;  use   HttpOz\\Roles\\Contracts\\HasRole   as   HasRoleContract ;  class   User   extends   Authenticatable   implements   HasRoleContract  { \n     use   Notifiable ,   HasRole ;   And that's it!",
            "title": "Enable HasRole Trait And Contract"
        },
        {
            "location": "/configuration/#config-file",
            "text": "You can change connection for models, slug separator, models path and there is also a handy pretend feature. Have a look at config file for more information.",
            "title": "Config File"
        },
        {
            "location": "/roles/creating-roles/",
            "text": "Use Case\n\n\nWe will be creating an Admin and Forum Moderator role.\n\n\n\n\nFirst we need to create the seeder file using \nphp artisan\n.\n\n    php artisan make:seeder UserRolesSeeder\n\n\n\n\n\nDefine roles in seeder file\n\n\nIn the seeder file we created above, which should be located at \ndatabase\\seeds\\UserRolesSeeder.php\n, we will define the roles in the \nrun\n method.\n\n\n    \n\\HttpOz\\Roles\\Models\\Role\n::\ncreate\n([\n\n        \n'name'\n \n=>\n \n'Admin'\n,\n\n        \n'slug'\n \n=>\n \n'admin'\n,\n\n        \n'description'\n \n=>\n \n'Custodians of the system.'\n,\n \n// optional\n\n        \n'group'\n \n=>\n \n'default'\n \n// optional, set as 'default' by default\n\n    \n]);\n\n\n    \n\\HttpOz\\Roles\\Models\\Role\n::\ncreate\n([\n\n        \n'name'\n \n=>\n \n'Forum Moderator'\n,\n\n        \n'slug'\n \n=>\n \n'forum.moderator'\n,\n\n    \n]);\n\n\n\n\n\n\n\n\nTip\n\n\nBecause of Sluggable trait, if you make a mistake and for example leave a space in slug parameter, it will be replaced with a dot automatically, because of str_slug function.\n\n\n\n\nSeeding the created Roles\n\n\nTo be able to call the UserRolesSeeder when we run \nphp artisan db:seed\n we need to add it to the run method in the \ndatabase\\seeds\\DatabaseSeeder.php\n file.\n\n\n    \n$this\n->\ncall\n(\nUserRolesSeeder\n::\nclass\n);\n\n\n\n\n\n\nWhen we run db:seed in php artisan the roles will be created in the database.\n\n\n    php artisan db:seed",
            "title": "Creating Roles"
        },
        {
            "location": "/roles/creating-roles/#define-roles-in-seeder-file",
            "text": "In the seeder file we created above, which should be located at  database\\seeds\\UserRolesSeeder.php , we will define the roles in the  run  method.       \\HttpOz\\Roles\\Models\\Role :: create ([ \n         'name'   =>   'Admin' , \n         'slug'   =>   'admin' , \n         'description'   =>   'Custodians of the system.' ,   // optional \n         'group'   =>   'default'   // optional, set as 'default' by default \n     ]); \n\n     \\HttpOz\\Roles\\Models\\Role :: create ([ \n         'name'   =>   'Forum Moderator' , \n         'slug'   =>   'forum.moderator' , \n     ]);    Tip  Because of Sluggable trait, if you make a mistake and for example leave a space in slug parameter, it will be replaced with a dot automatically, because of str_slug function.",
            "title": "Define roles in seeder file"
        },
        {
            "location": "/roles/creating-roles/#seeding-the-created-roles",
            "text": "To be able to call the UserRolesSeeder when we run  php artisan db:seed  we need to add it to the run method in the  database\\seeds\\DatabaseSeeder.php  file.       $this -> call ( UserRolesSeeder :: class );   When we run db:seed in php artisan the roles will be created in the database.      php artisan db:seed",
            "title": "Seeding the created Roles"
        },
        {
            "location": "/roles/assigning-roles/",
            "text": "Assigning / attaching roles has 2 very simple use cases - on creating a user (in seed file or controller) and attaching a role to an existing user.\n\n\nOn creating a user\n\n\nAssuming you are on a fresh install of Laravel, you would need to create a users table seeder. If you are creating users dynamically in a controller, then you do not need to create a seeder file.\n\n\n    php artisan make:seeder UsersTableSeeder\n\n\n\n\n\nIn the run function of your UsersTableSeeder (or controller), you would need to execute the following 3 steps:\n\n\n    \n// 1. query the Roles by the slug\n\n    \n$adminRole\n \n=\n \n\\HttpOz\\Roles\\Models\\Role\n::\nwhereSlug\n(\n'admin'\n)\n->\nfirst\n();\n\n    \n$moderatorRole\n \n=\n \n\\HttpOz\\Roles\\Models\\Role\n::\nwhereSlug\n(\n'forum.moderator'\n)\n->\nfirst\n();\n\n\n    \n// 2a. Create admin\n\n    \n$admin\n \n=\n \n\\App\\User\n::\ncreate\n([\n\n        \n'name'\n \n=>\n \n'Oscar Mwanandimai'\n,\n\n        \n'email'\n \n=>\n \n'oscar@github.com'\n,\n\n        \n'password'\n \n=>\n \nbcrypt\n(\n'password'\n)\n\n    \n]);\n\n\n    \n// 2b. Create forum moderator\n\n    \n$moderator\n \n=\n \n\\App\\User\n::\ncreate\n([\n\n        \n'name'\n \n=>\n \n'John Doe'\n,\n\n        \n'email'\n \n=>\n \n'john@github.com'\n,\n\n        \n'password'\n \n=>\n \nbcrypt\n(\n'password'\n)\n\n    \n]);\n\n\n    \n// 3. Attach a role to the user object / assign a role to a user\n\n    \n$admin\n->\nattachRole\n(\n$adminRole\n);\n\n    \n$moderator\n->\nattachRole\n(\n$moderatorRole\n);\n\n\n\n\n\n\nIf you took the database seeder route\n\n    php artisan db:seed",
            "title": "Assigning Roles"
        },
        {
            "location": "/roles/assigning-roles/#on-creating-a-user",
            "text": "Assuming you are on a fresh install of Laravel, you would need to create a users table seeder. If you are creating users dynamically in a controller, then you do not need to create a seeder file.      php artisan make:seeder UsersTableSeeder  In the run function of your UsersTableSeeder (or controller), you would need to execute the following 3 steps:       // 1. query the Roles by the slug \n     $adminRole   =   \\HttpOz\\Roles\\Models\\Role :: whereSlug ( 'admin' ) -> first (); \n     $moderatorRole   =   \\HttpOz\\Roles\\Models\\Role :: whereSlug ( 'forum.moderator' ) -> first (); \n\n     // 2a. Create admin \n     $admin   =   \\App\\User :: create ([ \n         'name'   =>   'Oscar Mwanandimai' , \n         'email'   =>   'oscar@github.com' , \n         'password'   =>   bcrypt ( 'password' ) \n     ]); \n\n     // 2b. Create forum moderator \n     $moderator   =   \\App\\User :: create ([ \n         'name'   =>   'John Doe' , \n         'email'   =>   'john@github.com' , \n         'password'   =>   bcrypt ( 'password' ) \n     ]); \n\n     // 3. Attach a role to the user object / assign a role to a user \n     $admin -> attachRole ( $adminRole ); \n     $moderator -> attachRole ( $moderatorRole );   If you took the database seeder route     php artisan db:seed",
            "title": "On creating a user"
        },
        {
            "location": "/roles/",
            "text": "Attaching, Syncing And Detaching Roles\n\n\nIt's really simple. You fetch a user from database and call \nattachRole\n method. There is \nBelongsToMany\n relationship between \nUser\n and \nRole\n model.\nLearn about \nMany To Many Relationships\n\n\nuse\n \nApp\\User\n;\n\n\n\n$user\n \n=\n \nUser\n::\nfind\n(\n$id\n);\n\n\n\n$user\n->\nattachRole\n(\n$adminRole\n);\n \n// you can pass whole object, or just an id\n\n\n$user\n->\ndetachRole\n(\n$adminRole\n);\n \n// in case you want to detach role\n\n\n$user\n->\ndetachAllRoles\n();\n \n// in case you want to detach all roles\n\n\n$user\n->\nsyncRoles\n(\n$roles\n);\n \n// you can pass Eloquent collection, or just an array of ids\n\n\n\n\n\n\nChecking For Roles\n\n\nYou can now check if the user has required role.\n\n\nif\n \n(\n$user\n->\nisRole\n(\n'admin'\n))\n \n{\n \n// you can pass an id or slug\n\n    \n// or alternatively $user->hasRole('admin')\n\n\n}\n\n\n\n\n\n\nYou can also do this:\n\n\nif\n \n(\n$user\n->\nisAdmin\n())\n \n{\n\n    \n//\n\n\n}\n\n\n\n\n\n\nAnd of course, there is a way to check for multiple roles:\n\n\nif\n \n(\n$user\n->\nisRole\n(\n'admin|moderator'\n))\n \n{\n\n    \n/*\n\n\n    | Or alternatively:\n\n\n    | $user->isRole('admin, moderator'), $user->isRole(['admin', 'moderator']),\n\n\n    | $user->isOne('admin|moderator'), $user->isOne('admin, moderator'), $user->isOne(['admin', 'moderator'])\n\n\n    */\n\n\n    \n// if user has at least one role\n\n\n}\n\n\n\nif\n \n(\n$user\n->\nisRole\n(\n'admin|moderator'\n,\n \ntrue\n))\n \n{\n\n    \n/*\n\n\n    | Or alternatively:\n\n\n    | $user->isRole('admin, moderator', true), $user->isRole(['admin', 'moderator'], true),\n\n\n    | $user->isAll('admin|moderator'), $user->isAll('admin, moderator'), $user->isAll(['admin', 'moderator'])\n\n\n    */\n\n\n    \n// if user has all roles\n\n\n}\n\n\n\n\n\n\nFind users by their role\n\n\nThere are multiple ways to get a list of users by their given role.\n\n\nUsing the role's id\n\n \n$admins\n \n=\n \nRole\n::\nfind\n(\n1\n)\n->\nusers\n;\n\n\n\n\n\n\nUsing the role's slug\n\n \n$adminRole\n \n=\n \nRole\n::\nwhere\n(\n'slug'\n,\n \n'admin'\n)\n->\nfirst\n();\n\n\n$admins\n \n=\n \n$role\n->\nusers\n;\n\n\n\n\n \nUsing the role's group\n\n \n$adminRole\n \n=\n \nRole\n::\nwhere\n(\n'group'\n,\n \n'application.managers'\n)\n->\nfirst\n();\n\n\n$admins\n \n=\n \n$role\n->\nusers\n;",
            "title": "Roles"
        },
        {
            "location": "/roles/#attaching-syncing-and-detaching-roles",
            "text": "It's really simple. You fetch a user from database and call  attachRole  method. There is  BelongsToMany  relationship between  User  and  Role  model.\nLearn about  Many To Many Relationships  use   App\\User ;  $user   =   User :: find ( $id );  $user -> attachRole ( $adminRole );   // you can pass whole object, or just an id  $user -> detachRole ( $adminRole );   // in case you want to detach role  $user -> detachAllRoles ();   // in case you want to detach all roles  $user -> syncRoles ( $roles );   // you can pass Eloquent collection, or just an array of ids",
            "title": "Attaching, Syncing And Detaching Roles"
        },
        {
            "location": "/roles/#checking-for-roles",
            "text": "You can now check if the user has required role.  if   ( $user -> isRole ( 'admin' ))   {   // you can pass an id or slug \n     // or alternatively $user->hasRole('admin')  }   You can also do this:  if   ( $user -> isAdmin ())   { \n     //  }   And of course, there is a way to check for multiple roles:  if   ( $user -> isRole ( 'admin|moderator' ))   { \n     /*      | Or alternatively:      | $user->isRole('admin, moderator'), $user->isRole(['admin', 'moderator']),      | $user->isOne('admin|moderator'), $user->isOne('admin, moderator'), $user->isOne(['admin', 'moderator'])      */ \n\n     // if user has at least one role  }  if   ( $user -> isRole ( 'admin|moderator' ,   true ))   { \n     /*      | Or alternatively:      | $user->isRole('admin, moderator', true), $user->isRole(['admin', 'moderator'], true),      | $user->isAll('admin|moderator'), $user->isAll('admin, moderator'), $user->isAll(['admin', 'moderator'])      */ \n\n     // if user has all roles  }",
            "title": "Checking For Roles"
        },
        {
            "location": "/roles/#find-users-by-their-role",
            "text": "There are multiple ways to get a list of users by their given role.  Using the role's id \n  $admins   =   Role :: find ( 1 ) -> users ;    Using the role's slug \n  $adminRole   =   Role :: where ( 'slug' ,   'admin' ) -> first ();  $admins   =   $role -> users ;  \n\n  Using the role's group \n  $adminRole   =   Role :: where ( 'group' ,   'application.managers' ) -> first ();  $admins   =   $role -> users ;",
            "title": "Find users by their role"
        },
        {
            "location": "/groups/",
            "text": "When you are creating roles, there is optional parameter \ngroup\n. It is set as \ndefault\n by default, but you can overwrite it and then you can do something like this:\n\n\nif\n \n(\n$user\n->\ngroup\n()\n \n==\n \n'application.managers'\n)\n \n{\n\n    \n//\n\n\n}\n\n\n\n\n\n\n\n\nIf user has multiple roles, method \ngroup\n returns the first one in alphabetical order (a better implementation of this will be explored).\n\n\n\n\nGroup\n is intended to collectively organise and assign permissions (Laravel's built in authorization feature) to a role group that can be shared by multiple roles (examples and implementation to be added to documentation in future).",
            "title": "Groups"
        },
        {
            "location": "/middleware/",
            "text": "This package comes with \nVerifyRole\n and \nVerifyGroup\n middleware. You must add them inside your \napp/Http/Kernel.php\n file.\n\n\n/**\n\n\n * The application's route middleware.\n\n\n *\n\n\n * @var array\n\n\n */\n\n\nprotected\n \n$routeMiddleware\n \n=\n \n[\n\n\n    \n// ...\n\n\n    \n'role'\n \n=>\n \n\\HttpOz\\Roles\\Middleware\\VerifyRole\n::\nclass\n,\n\n    \n'group'\n \n=>\n \n\\HttpOz\\Roles\\Middleware\\VerifyGroup\n::\nclass\n,\n\n\n];\n\n\n\n\n\n\nNow you can easily protect your routes.\n\n\n$router\n->\nget\n(\n'/example'\n,\n \n[\n\n    \n'as'\n \n=>\n \n'example'\n,\n\n    \n'middleware'\n \n=>\n \n'role:admin'\n,\n\n    \n'uses'\n \n=>\n \n'ExampleController@index'\n,\n\n\n]);\n\n\n\n$router\n->\nget\n(\n'/example'\n,\n \n[\n\n    \n'as'\n \n=>\n \n'example'\n,\n\n    \n'middleware'\n \n=>\n \n'group:application.managers'\n,\n\n    \n'uses'\n \n=>\n \n'ExampleController@index'\n,\n\n\n]);\n\n\n\n\n\n\nIt throws \n\\HttpOz\\Roles\\Exceptions\\RoleDeniedException\n or \n\\HttpOz\\Roles\\Exceptions\\GoupDeniedException\n exceptions if it goes wrong.\n\n\nYou can catch these exceptions inside \napp/Exceptions/Handler.php\n file and do whatever you want, example below.",
            "title": "Middleware"
        },
        {
            "location": "/displaying-errors/",
            "text": "Extending from the above, you can control the error page that your application users see when they try to open a page their role is not allowed to. This package already has a view bundled with it that should have been published to \nresources/views/vendor/roles/error.blade.php\n when you published the package. Simply add the below condition inside your \napp\\Exceptions\\Handler.php\n's render function. Feel free to point to another view of your choice.\n\n\n/**\n\n\n     * Render an exception into an HTTP response.\n\n\n     *\n\n\n     * @param  \\Illuminate\\Http\\Request  $request\n\n\n     * @param  \\Exception  $exception\n\n\n     * @return \\Illuminate\\Http\\Response\n\n\n     */\n\n    \npublic\n \nfunction\n \nrender\n(\n$request\n,\n \nException\n \n$exception\n)\n\n    \n{\n\n        \nif\n \n(\n$exception\n \ninstanceof\n \n\\HttpOz\\Roles\\Exceptions\\RoleDeniedException\n \n||\n \n$exception\n \ninstanceof\n \n\\HttpOz\\Roles\\Exceptions\\GroupDeniedException\n)\n \n{\n\n            \nreturn\n \nresponse\n()\n->\nview\n(\n'vendor.roles.error'\n,\n \ncompact\n(\n'exception'\n),\n \n403\n);\n\n        \n}\n\n\n        \nreturn\n \nparent\n::\nrender\n(\n$request\n,\n \n$exception\n);\n\n    \n}",
            "title": "Displaying Errors"
        },
        {
            "location": "/blade-syntax/",
            "text": "There are two Blade extensions that are basically a replacement for classic if statements.\n\n\n@\nrole\n(\n'admin'\n)\n \n// @if(Auth::check() && Auth::user()->isRole('admin'))\n\n    \n// user is admin\n\n\n@\nendrole\n\n\n\n@\ngroup\n(\n'application.managers'\n)\n \n// @if(Auth::check() && Auth::user()->group() == 'application.managers')\n\n    \n// user belongs to 'application.managers' group\n\n\n@\nendgroup\n\n\n\n@\nrole\n(\n'admin|moderator'\n,\n \n'all'\n)\n \n// @if(Auth::check() && Auth::user()->isRole('admin|moderator', 'all'))\n\n    \n// user is admin and also moderator\n\n\n@\nelse\n\n    \n// something else\n\n\n@\nendrole",
            "title": "Blade Syntax"
        }
    ]
}